# Render Environment Variables Guide

This guide shows which environment variables are **already configured** in `render.yaml` and which ones you **need to set manually** in the Render dashboard.

---

## ‚úÖ Already Auto-Configured (Don't Set These)

These are automatically set by `render.yaml` - **DO NOT** set them manually:

- ‚úÖ `NODE_ENV` = `production` (auto-set)
- ‚úÖ `DATABASE_URL` = `file:/var/data/db.sqlite` (auto-set)
- ‚úÖ `BETTER_AUTH_URL` = Your Render URL (auto-set from service)
- ‚úÖ `NEXT_PUBLIC_APP_URL` = Your Render URL (auto-set from service)
- ‚úÖ `AUTH_SECRET` = Auto-generated by Render
- ‚úÖ `BOOK_STORAGE_PATH` = `/var/data/books` (auto-set)
- ‚úÖ `COVER_STORAGE_PATH` = `/var/data/covers` (auto-set)
- ‚úÖ `REPORT_STORAGE_PATH` = `/var/data/reports` (auto-set)
- ‚úÖ `UPLOAD_DIR` = `/var/data/uploads` (auto-set)
- ‚úÖ `BOOK_REPORTS_PATH` = `/var/data/book-reports` (auto-set)
- ‚úÖ `BOOKDIGEST_URL` = `https://bookdigest.onrender.com` (auto-set)

---

## üî¥ Required - Must Set in Render Dashboard

These are **required** for the app to work properly. Set them in Render Dashboard ‚Üí Your Service ‚Üí Environment:

### 1. Admin Access
```bash
SUPER_ADMIN_EMAILS=your-email@example.com
NEXT_PUBLIC_SUPER_ADMIN_EMAILS=your-email@example.com
```
**Why**: Makes you an admin so you can access the admin panel.

### 2. Email Service (Resend)
```bash
RESEND_API_KEY=re_xxxxxxxxxxxxx
RESEND_FROM_EMAIL=onboarding@resend.dev
```
**Why**: Required for email verification and notifications.
- For testing: Use `onboarding@resend.dev` (only sends to your account email)
- For production: Verify your domain and use `noreply@yourdomain.com`

---

## üü° Optional - Set If You Need These Features

### Google OAuth (Optional)
```bash
AUTH_GOOGLE_ID=your-google-client-id.apps.googleusercontent.com
AUTH_GOOGLE_SECRET=your-google-client-secret
```
**Why**: Enables "Sign in with Google" button.
**Note**: If not set, Google sign-in will be hidden automatically.

### Stripe Payments (Optional)
```bash
STRIPE_SECRET_KEY=sk_test_xxxxxxxxxxxxx
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_xxxxxxxxxxxxx
STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxx
```
**Why**: Enables real Stripe payments.
**Note**: If not set, the app uses simulated purchases (for testing).

### Testing Mode (Optional)
```bash
USE_SIMULATED_PURCHASES=true
```
**Why**: Forces simulated purchases even if Stripe is configured.
**Note**: Only set this if you want to test without real payments.

### BookDigest Service (Optional)
```bash
BOOKDIGEST_API_KEY=your-bookdigest-api-key
```
**Why**: If you're using the BookDigest service for metadata extraction.
**Note**: The app now uses local EPUB extraction, so this may not be needed.

### AI Services (Optional)
```bash
OPENAI_API_KEY=sk-xxxxxxxxxxxxx
ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxx
```
**Why**: If you plan to use AI features in the future.
**Note**: Not currently used, but reserved for future features.

### Legacy/Unused (Don't Set)
These are in `render.yaml` but not currently used:
- `TURSO_DATABASE_URL` - Not used (using SQLite)
- `TURSO_AUTH_TOKEN` - Not used (using SQLite)
- `GMAIL_USER` - Not used (using Resend)
- `GMAIL_PASS` - Not used (using Resend)

---

## üìã Quick Setup Checklist

### Minimum Required (App Works)
- [ ] `SUPER_ADMIN_EMAILS` = Your email
- [ ] `NEXT_PUBLIC_SUPER_ADMIN_EMAILS` = Your email (same as above)
- [ ] `RESEND_API_KEY` = Your Resend API key
- [ ] `RESEND_FROM_EMAIL` = `onboarding@resend.dev` (for testing)

### Recommended (Better Experience)
- [ ] `AUTH_GOOGLE_ID` = Google OAuth Client ID
- [ ] `AUTH_GOOGLE_SECRET` = Google OAuth Client Secret

### Optional (If Using)
- [ ] `STRIPE_SECRET_KEY` = Stripe secret key
- [ ] `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY` = Stripe publishable key
- [ ] `STRIPE_WEBHOOK_SECRET` = Stripe webhook secret

---

## üöÄ How to Set in Render Dashboard

1. Go to [Render Dashboard](https://dashboard.render.com)
2. Click on your service (`getlostportal`)
3. Click **"Environment"** in the left sidebar
4. Click **"Add Environment Variable"**
5. Enter the **Key** and **Value**
6. Click **"Save Changes"**
7. Render will automatically redeploy

---

## ‚ö†Ô∏è Important Notes

### 1. Don't Duplicate Variables
- If a variable is already in `render.yaml` with a value, **don't set it again** in the dashboard
- If it says `sync: false`, you **must** set it in the dashboard

### 2. Sensitive Values
- Never commit secrets to git
- Render dashboard encrypts all environment variables
- Use Render's environment variable UI for all secrets

### 3. After Adding Variables
- Render automatically redeploys when you save environment variables
- Check the logs to verify the app starts correctly
- Test the features that depend on the new variables

### 4. Testing Locally
- Keep your local `.env` file for development
- Don't commit `.env` to git (it's in `.gitignore`)
- Use different values for local vs production

---

## üîç How to Verify

After setting variables, check the logs:

1. **Google OAuth**: Look for `‚úÖ [Better Auth] Google OAuth configured`
2. **Email**: Try signing up - you should receive a verification email
3. **Admin Access**: Try accessing `/admin` - you should have access
4. **Stripe**: Try purchasing a feature - should work if configured

---

## üìù Example: Minimal Setup

For a basic working deployment, set only these 4 variables:

```bash
SUPER_ADMIN_EMAILS=eero@getlost.ink
NEXT_PUBLIC_SUPER_ADMIN_EMAILS=eero@getlost.ink
RESEND_API_KEY=re_xxxxxxxxxxxxx
RESEND_FROM_EMAIL=onboarding@resend.dev
```

This gives you:
- ‚úÖ Admin access
- ‚úÖ Email verification
- ‚úÖ Email notifications
- ‚úÖ Email/password sign-in
- ‚ùå No Google sign-in (button hidden)
- ‚ùå No Stripe payments (uses simulated)

---

## üìù Example: Full Setup

For full features, add:

```bash
# Required (from above)
SUPER_ADMIN_EMAILS=eero@getlost.ink
NEXT_PUBLIC_SUPER_ADMIN_EMAILS=eero@getlost.ink
RESEND_API_KEY=re_xxxxxxxxxxxxx
RESEND_FROM_EMAIL=noreply@getlost.ink

# Google OAuth
AUTH_GOOGLE_ID=xxxxx.apps.googleusercontent.com
AUTH_GOOGLE_SECRET=xxxxx

# Stripe
STRIPE_SECRET_KEY=sk_live_xxxxx
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_live_xxxxx
STRIPE_WEBHOOK_SECRET=whsec_xxxxx
```

---

## üÜò Troubleshooting

### "Provider not found" error
- **Cause**: Google OAuth credentials not set
- **Fix**: Add `AUTH_GOOGLE_ID` and `AUTH_GOOGLE_SECRET`, or the button will be hidden

### "Email not sending"
- **Cause**: Resend not configured
- **Fix**: Add `RESEND_API_KEY` and `RESEND_FROM_EMAIL`

### "Forbidden" on admin panel
- **Cause**: Admin emails not set
- **Fix**: Add `SUPER_ADMIN_EMAILS` with your email

### Stripe not working
- **Cause**: Stripe keys not set
- **Fix**: Add Stripe keys, or use simulated purchases (set `USE_SIMULATED_PURCHASES=true`)

---

## ‚úÖ Summary

**Set in Render Dashboard:**
- ‚úÖ Required: Admin emails, Resend keys
- ‚úÖ Optional: Google OAuth, Stripe keys
- ‚ùå Don't set: Variables already in `render.yaml` with values

**The app will work with just the 4 required variables!**

