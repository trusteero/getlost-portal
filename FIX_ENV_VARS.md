# Fix: Invalid Environment Variables Error

## üîç The Problem

Build fails with: `Error: Invalid environment variables`

This means one or more **required** environment variables are missing or empty in Render.

## ‚úÖ Required Environment Variables

Based on `src/env.js`, these are **REQUIRED** (cannot be empty):

### Must Have:

1. **`AUTH_GOOGLE_ID`** ‚ö†Ô∏è REQUIRED
   - Your Google OAuth Client ID
   - Get from: [Google Cloud Console](https://console.cloud.google.com)

2. **`AUTH_GOOGLE_SECRET`** ‚ö†Ô∏è REQUIRED
   - Your Google OAuth Client Secret
   - Get from: [Google Cloud Console](https://console.cloud.google.com)

3. **`DATABASE_URL`** ‚ö†Ô∏è REQUIRED
   - Should be: `file:/var/data/db.sqlite`
   - (Already set by render.yaml, but verify it's there)

4. **`AUTH_SECRET`** ‚ö†Ô∏è REQUIRED in Production
   - Auto-generated by render.yaml
   - But verify it exists in Environment tab

### Optional (can be empty):

- `SUPER_ADMIN_EMAILS` (optional)
- `NEXT_PUBLIC_SUPPORTED_FORMATS` (optional)
- `NEXT_PUBLIC_SUPER_ADMIN_EMAILS` (optional)

---

## üîß How to Fix

### Step 1: Go to Render Dashboard

1. Open your Render service
2. Click **"Environment"** tab

### Step 2: Add Missing Variables

Check if these exist and have values:

#### Required Variables:

```bash
# 1. Google OAuth (REQUIRED - get from Google Cloud Console)
AUTH_GOOGLE_ID=your-google-client-id-here
AUTH_GOOGLE_SECRET=your-google-client-secret-here

# 2. Database (should already be set by render.yaml)
DATABASE_URL=file:/var/data/db.sqlite

# 3. Auth Secret (should be auto-generated, but verify)
AUTH_SECRET=[should be auto-generated]
```

### Step 3: Verify No Empty Values

**Important**: Empty strings are treated as missing!

- ‚ùå `AUTH_GOOGLE_ID=` (empty)
- ‚úÖ `AUTH_GOOGLE_ID=123456789-abc.apps.googleusercontent.com`

### Step 4: Get Google OAuth Credentials

If you don't have Google OAuth credentials yet:

1. Go to [Google Cloud Console](https://console.cloud.google.com)
2. **APIs & Services** ‚Üí **Credentials**
3. Click **"Create Credentials"** ‚Üí **"OAuth 2.0 Client ID"**
4. Application type: **"Web application"**
5. Add authorized redirect URI:
   ```
   https://your-app-name.onrender.com/api/auth/callback/google
   ```
6. Copy **Client ID** ‚Üí Set as `AUTH_GOOGLE_ID`
7. Copy **Client Secret** ‚Üí Set as `AUTH_GOOGLE_SECRET`

### Step 5: Save and Redeploy

1. Click **"Save Changes"** in Render
2. Render will automatically rebuild
3. Check build logs - should succeed now!

---

## üìã Quick Checklist

Before deploying, verify in Render Environment tab:

- [ ] `AUTH_GOOGLE_ID` is set (not empty)
- [ ] `AUTH_GOOGLE_SECRET` is set (not empty)
- [ ] `DATABASE_URL=file:/var/data/db.sqlite` exists
- [ ] `AUTH_SECRET` exists (auto-generated is fine)
- [ ] `NODE_ENV=production` (set by render.yaml)
- [ ] No variables have empty values

---

## üêõ Common Mistakes

1. **Empty string instead of missing**
   - ‚ùå `AUTH_GOOGLE_ID=` (empty string)
   - ‚úÖ Remove the variable entirely OR set a real value

2. **Wrong variable name**
   - ‚ùå `GOOGLE_CLIENT_ID` (wrong name)
   - ‚úÖ `AUTH_GOOGLE_ID` (correct name)

3. **Missing quotes**
   - Usually fine, but if value has spaces, use quotes:
   - ‚úÖ `AUTH_GOOGLE_ID="value with spaces"`

---

## üöÄ After Fixing

Once all required variables are set:

1. Save changes in Render
2. Build will automatically restart
3. Check build logs - should say "Build succeeded"
4. App should deploy successfully!

---

## üí° Quick Test

To test if variables are set correctly, you can temporarily add this to your build command to see what's available:

```bash
# Add to build command (temporary, for debugging)
env | grep AUTH
```

But the easiest way is to just check the Environment tab in Render!

